from exploit import Exploit
import requests
from bs4 import BeautifulSoup
import sys

def test_exploit_request():
    e = Exploit(ebd_id='49366')
    request = e.request_exploit_data()
    assert request.status_code == 200
    assert request.encoding == 'utf-8'
    assert sys.getsizeof(request.content) > 180000


def test_exploit_db_entry():
    e = Exploit(ebd_id='49371')
    request = e.request_exploit_data()
    entry = e.parse_exploit_data(request)
    assert entry['exploit_id'].isdigit()
    if entry['cve_ids']:
        assert 'CVE-' in entry['cve_ids']
    else:
        assert 'cve_ids' in entry
    assert 'created_at' in entry