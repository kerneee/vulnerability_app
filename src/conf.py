import sys, os
sys.path.insert(0, os.path.abspath('..'))
import logging


logger = logging.getLogger().setLevel(logging.INFO)

break_text = '--------------------------------------------------'
start_text = 'This is your personal vulnerability management app. You can manage CVE from nvd.nist.gov and exploits from exploit.db'
start_error = 'Invalid input. Enter "exploit" or "cve" or "exit" to close the app.'

start_cve = 'You entered the CVE area. Here you can access existing CVE elements in the db or request new one. If you want to add new CVE elements to the db enter: "add cve". If you want to access a specific element enter "view cve".'
start_cve_error = 'Invalid input. Enter "add cve" or "view cve" to enter the specific area.'
start_cve_add = 'You want to add CVE elements to the db. Enter a year between 2002 and 2020, which you want to add to db'
start_cve_add_error = 'Invalid input. Enter a year between 2002 and 2020.'
start_cve_view = 'You want to view CVE elements in the db. Enter a CVE-ID (e.g. CVE-2020-1987) to access.'
start_cve_view_error = 'Invalid CVE ID. Enter a CVE-ID with format e.g. CVE-2020-1987)'
start_cve_error = 'Invalid input. Enter "Add" or "View" to enter the specific area.'

start_exploit = 'You entered the exploit area. Here you can access existing exploit elements in the db or request new one. If you want to add new exploit element to the db enter: "add exploit". If you want to access a specific element enter "view exploit".'
start_exploit_add = 'You want to add an exploit to the db. Enter an id between 1 and 49000.'
start_exploit_add_error = 'Invalid input. Enter an id between 1 and 49000.'
start_exploit_view = 'You wan to view an exploit of the db. Enter an id.'
start_exploit_view_error = 'Invalid input. Enter an id between 1 and 49000.'

sequences = {
        'start': {'text': start_text, 'input': 'Enter cve or exploit', 'pattern': 'cve|exploit'},
        'start_error': {'text': start_text, 'input': 'Enter cve or exploit', 'pattern': 'cve|exploit'},
        'cve': {'text': start_cve, 'input': '"add cve" for adding CVE // "view cve" for viewing CVE', 'pattern': '(add cve|view cve)'},
        'cve_error': {'text': start_cve_error},
        'add cve': {'text': start_cve_add, 'input': 'Enter year between 2002 and 2020', 'pattern': '(200[2-9]|201[0-9]|2020)', 'method':'cve_to_db', 'type': 'cve'},
        'add cve_error': {'text': start_cve_add_error},
        'view cve': {'text': start_cve_view, 'input': 'Enter CVE-ID', 'pattern': 'CVE-\d{4}-\d{1,5}', 'method': 'get_cve_from_db', 'type': 'cve'},
        'view cve_error': {'text': start_cve_view_error},
        'exploit': {'text': start_exploit, 'input': 'Enter "add exploit" or "view exploit"', 'pattern': '(add exploit|view exploit)'},
        'add exploit': {'text': start_exploit_add, 'input': 'Enter exploit id between 1 and 49000', 'pattern': '[1-49000]', 'method': 'exploit_to_db', 'type': 'exploit'},
        'view exploit': {'text': start_exploit_view, 'input': 'Enter exploit id between 1 and 49000', 'pattern': '[1-49000]', 'method': 'get_exploit_from_db', 'type': 'exploit'},
        'add exploit_error': {'text': start_exploit_add_error},
        'view exploit_error': {'text': start_cve_view_error}
}